<% if Decidim::TrustedIds.census_config_attributes.present? %>
  <div class="fieldset">
    <div class="field">
      <h4><%= t("decidim.trusted_ids.system.settings", handler: t("decidim.authorization_handlers.trusted_ids_census_handler.name")) %></h4>
      <%= f.fields_for :trusted_ids_census_config do |fields| %>
        <% Decidim::TrustedIds.census_config_attributes.each do |setting, _type| %>
          <div class="field">
            <%= fields.text_field setting.to_sym, value: f.object.trusted_ids_census_settings&.dig(setting.to_s), label: t("activemodel.attributes.trusted_ids_census_config.settings.#{setting}") %>
          </div>
        <% end %>
        <div class="field">
          <%= fields.text_field :expiration_days, value: f.object.trusted_ids_census_settings&.dig("expiration_days"), label: t("activemodel.attributes.trusted_ids_census_config.settings.expiration_days", days: @form.default_expiration_days), placeholder: @form.default_expiration_days.to_s %>
          <%= f.check_box :census_expiration_apply_all_tenants, label: t("activemodel.attributes.trusted_ids_census_config.census_expiration_apply_all_tenants") %>
        </div>
        <div class="field">
          <%= fields.text_area :tos, value: f.object.trusted_ids_census_settings&.dig("tos"), label: t("activemodel.attributes.trusted_ids_census_config.settings.tos"), rows: 5, placeholder: @form.default_tos %>
          <%= f.check_box :census_tos_apply_all_tenants, label: t("activemodel.attributes.trusted_ids_census_config.census_tos_apply_all_tenants") %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
